<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BSM</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Lilita+One&family=Quicksand:wght@300..700&display=swap" rel="stylesheet">
</head>

<script>
  var attackData = [
    {
      name : "Attack 1",
      desc : "description text",
      damage : 2000,
      projectiles : 1,
      superCharge : 25,
      ammo: 3,
      reloadSpeed : 1.25,
      attackForm : 0,
      distance : 7,
      radius : 1,
    },
  ];
  var mode = 1;
  var speedTiers = ["Very slow","Slow","Normal","Fast","Very fast"];
  var rarities = ['Rare','Super rare', 'Epic', 'Mythic', 'Legendary', 'Ultra'];
  var traits = []
  var presetTraits={
    "tank charge":{
      icon:"",
      desc:"Charges super by taking damage",
    },
    "auto charge":{
      icon:"",
      desc:"Charges super over time",
    },
    "starting charge":{
      icon:"",
      desc:"Spawns in with the super charged",
    },
    "water walk":{
      icon:"",
      desc:"Allows for traversal over water",
    },
    "enemy proximity":{
      icon:"",
      desc:"Charges super by being close to enemies",
    },
    "ally proximity":{
      icon:"",
      desc:"Charges super by being close to allies",
    },
    "healing charge":{
      icon:"",
      desc:"Charges super by healing",
    },
    "evasion":{
      icon:"",
      desc:"Charges super by dodging nearby projectiles",
    },
    "hunt":{
      icon:"",
      desc:"Gain increased reload and movement speed when a nearby enemy is below 50% health"
    },
    

  }

  function tick(){
    document.getElementById('ammo').value = Math.round(document.getElementById('ammo').value)
    document.getElementById('projectiles').value = Math.round(document.getElementById('projectiles').value)

    document.getElementById('movement_speed_text').innerHTML=speedTiers[document.getElementById('movement_speed').value];
    document.getElementById('reload_speed_text').innerHTML=speedTiers[Math.round(4-3/2*document.getElementById('reload_speed').value)]+" ("+document.getElementById('reload_speed').value+")";
    
    document.getElementById('mode1').style="background-color:rgb(255,255,255,"+(mode==1?0.85:0.3)+")";
    document.getElementById('mode2').style="top:10px;left:20px;background-color:rgb(255,255,255,"+(mode==2?0.85:0.3)+")";
    document.getElementById('mode3').style="top:10px;left:30px;background-color:rgb(255,255,255,"+(mode==3?0.85:0.3)+")";
    document.getElementById('mode4').style="top:10px;left:40px;background-color:rgb(255,255,255,"+(mode==4?0.85:0.3)+")";
  
    const select = document.getElementById("attackSelect");
    const selectedIndex = select.selectedIndex;

    if (selectedIndex !== -1) {
      let atk = attackData[selectedIndex];
      //document.getElementById('damage').value
    }

    

  }
  
  setInterval(tick,0);

</script>

<style src = "style.css"></style>
<body class = "body">
    <p class = "title">Brawl Stars Maker</p>
    <p class = "author">Website made by TrueAceOfSpades</p>
    <div class = "section">
      <div style="display:flex;">
        <!--Mode Select-->
        <div id="mode1" class = "mode">
          <img onclick="mode=1;" class = "mode-icon" src = "mode1.png" style = "width:45px;position:relative;left:12.5px">
        </div>
        <div id="mode2" class = "mode" style = "top:10px;left:20px">
          <img class = "mode-icon" src = "mode2.png" onclick="mode=2;">
        </div>
        <div id="mode3" class = "mode" style = "top:10px;left:30px">
          <img class = "mode-icon" src = "mode3.png" onclick="mode=3;">
        </div>
        <div id="mode4" class = "mode" style = "top:10px;left:40px">
          <img class = "mode-icon" src = "mode4.png" onclick="mode=4;">
        </div>
        
      </div>
      <!--Settings-->
      <div style="display:flex">
        <p class="setting">Name:</p>
        <input class="input" id="name" value="untitled">
      </div>
      <div style="display:flex;position: relative;top:-35px">
        <p class="setting">Description:</p>
        <textarea class="textarea" id="description">description text</textarea>
      </div>
      <div style="display:flex;position: relative;top:-35px">
        <p class="setting">Movement Speed:</p>
        <input value="2" class="range" type = "range" step = 1 min = 0 max = 4 id="movement_speed">
        <p id="movement_speed_text" class="setting" style="left:30px">Normal</p>
      </div>
      
      <div style="display:flex;position: relative;top:-70px">
        <p class="setting">Rarity:</p>
        <select style="color:rgb(86, 86, 86);text-shadow: none;" class="input" name="dropdown_name" id="rarity">
          <option value="0">Rare</option>
          <option value="1">Super rare</option>
          <option value="2">Epic</option>
          <option value="3">Mythic</option>
          <option value="4">Legendary</option>
          <option value="5">Ultra</option>
          <option value="6">Starting?..</option>
        </select>

      </div>
      <div style="display:flex;position: relative;top:-105px">
        <p class="setting">Health:</p>
        <input style="width:80px;" value="6400" class="input" type = "number" step = 100 min = 100 id="health">

      </div>
      <div style="display:flex;position: relative;top:-135px">
        <p class="setting">Class:</p>
        <select style="color:rgb(86, 86, 86);text-shadow: none;" class="input" name="dropdown_name" id="class">
          <option value="0">Damage Dealer</option>
          <option value="1">Tank</option>
          <option value="2">Assassin</option>
          <option value="3">Controller</option>
          <option value="4">Marksman</option>
          <option value="5">Artillery</option>

          <option value="6" style="color:rgb(135, 116, 143)">Chipper</option>
          <option value="7" style="color:rgb(135, 116, 143)">Inflictor</option>
        </select>
        <p style="left:30px" class="setting">Sub class:</p>
        <select style="color:rgb(86, 86, 86);text-shadow: none;left:38px" class="input" name="dropdown_name" id="sub_class">
          <option value="-1">-</option>
          <option value="0">Damage Dealer</option>
          <option value="1">Tank</option>
          <option value="2">Assassin</option>
          <option value="3">Controller</option>
          <option value="4">Marksman</option>
          <option value="5">Artillery</option>

          <option value="6" style="color:rgb(135, 116, 143)">Chipper</option>
          <option value="7" style="color:rgb(135, 116, 143)">Inflictor</option>
        </select>
      </div>
      <div style="display:flex;position: relative;top:-135px">
        <script>
          function noAttack() {
            const select = document.getElementById("attackSelect");
            const selectedIndex = select.selectedIndex;

            if (selectedIndex !== -1) {
              select.remove(selectedIndex);
            }
            attackData.splice(selectedIndex,1);
      
          }
          function newAttack() {
            const select = document.getElementById("attackSelect");
            const count = select.options.length + 1;
            
            const newOption = new Option('Attack ' + count, count - 1, false, true);
          
            select.add(newOption);
            attackData.push(
              {
                name : "Attack 1",
                desc : "description text",
                damage : 2000,
                projectiles : 1,
                superCharge : 25,
                ammo: 3,
                reloadSpeed : 1.25,
                attackForm : 0,
                distance : 7,
                radius : 1,
              },);
          }
        </script>
        <p class="setting">Main attack:</p>
        <select style="color:rgb(86, 86, 86);text-shadow: none;left:30px" class="input" name="dropdown_name" id="attackSelect">
          <option value="0">Attack 1</option>
        </select>
        <button 
        onclick="newAttack();"
        style="color:rgb(86, 86, 86);text-shadow: none;left:40px;" class="input">
          New attack
        </button>
        <button 
        onclick="noAttack();"
        style="color:rgb(86, 86, 86);text-shadow: none;left:50px;" class="input">
          Remove attack
        </button>
        
      </div>
      <div class="attack" style="position: relative;top:-150px"></div>
        <div style="display:flex;position:relative;top:-650px;">
          <p class="setting">Name:</p>
          <input class="input" id="attack1name" value="Attack 1">
        </div>  
        <div style="display:flex;position: relative;top:-680px">
          <p class="setting">Damage:</p>
          <input style="width:70px;" value="2000" class="input" type = "number" step = 100 min = 100 id="damage">

          <p style="left:30px" class="setting">Projectiles:</p>
          <input style="width:30px;left:40px;" value="1" class="input" type = "number" step = 1 min = 0 id="projectiles">
          
          <p style="left:48px" class="setting">Super charge %:</p>
          <input style="width:50px;left:58px;" value="25" class="input" type = "number" step = 1 min = 0 id="super_charge">
          
          <p style="left:70px" class="setting">Ammo:</p>
          <input style="width:50px;left:80px;" value="3" class="input" type = "number" step = 1 min = 0 id="ammo">

        </div>
        <div style="display:flex;position: relative;top:-713px">
          <p class="setting">Reload Speed:</p>
          <input value="1.5" class="range" type = "range" step = 0.05 min = 0.05 max = 3 id="reload_speed">
          <p id="reload_speed_text" class="setting" style="left:30px">Normal (1.25)</p>
        </div>
        <div style="display:flex;position: relative;top:-750px">
          <p class="setting">Description:</p>
          <textarea class="textarea" id="attack_description">description text</textarea>
        </div>
        <div style="display:flex;position:relative;top:-530px">
          <p class="setting">Attack form:</p>
          <select style="color:rgb(86, 86, 86);text-shadow: none;left:28px" class="input" name="dropdown_name" id="attack_form1">
            <option value="0">Straight</option>
            <option value="1">Cone</option>
            <option value="2">Throw</option>
          </select>
          <p class="setting" style="left:40px">Distance:</p>
          <input style="width:60px;left:50px" value="7" class="input" type = "number" step = 0.3333 min = 0 id="attack_range1">
          <p class="setting" style="left:60px">Radius/Width:</p>
          <input style="width:60px;left:70px" value="1" class="input" type = "number" step = 0.3333 min = 0 id="attack_radius1">
        </div>
        <div style="display:flex;position:relative;top:-795px;">
          <canvas width=200 height=200 class="attack_form" id="attack_form1canvas"></canvas>
          <script>

            var zoom1 = 1
            
            function draw1(){
              const canvas = document.getElementById("attack_form1canvas");
              
              
              zoom1 = Math.min(5/(1+document.getElementById('attack_range1').value/3),2)
              if (canvas.getContext) {
                const ctx = canvas.getContext("2d");
                ctx.lineWidth = 3;
                function circle(x,y,r){
                  const centerX = x
                  const centerY = y
                  const radius = r
                  ctx.beginPath();
                  ctx.arc(centerX, centerY, radius, 0, 2* Math.PI);
                  
                  ctx.stroke();
                }
                ctx.clearRect(0, 0, canvas.width, canvas.height);
        
                //background
                ctx.globalAlpha = 1;
                ctx.fillStyle = "hsl(40 70 70)";
                ctx.fillRect(0,0,200,200);
                ctx.fillStyle = "hsl(40 70 60)";
                ctx.lineStyle = "hsl(100,100,100)"
                for(var i = 0; i < Math.ceil(20/zoom1); i++){
                  for(var ii = 0; ii < Math.ceil(10/zoom1); ii++){
                    ctx.fillRect(zoom1*ii*20+zoom1*10*(i%2),i*10*zoom1,10*zoom1,10*zoom1);
                  }
                }
                let tile = 10*zoom1;
                let x = Math.round(30/tile)*tile
                let y = Math.round(100/tile)*tile
                //player and attack

                ctx.fillStyle = "hsl(100 100 100)";
                ctx.strokeStyle = "hsl(100 100 100)";
                let form1 = document.getElementById('attack_form1').value;
                let radius1 = document.getElementById('attack_radius1').value;
                let range1 = document.getElementById('attack_range1').value;
                
                if (form1==0){
                  //straight
                  ctx.globalAlpha = 0.25;
                  ctx.fillRect(
                    x+10*zoom1,
                    y+zoom1*(5-5*radius1),
                    zoom1*10*range1,
                    zoom1*10*radius1);
                  ctx.globalAlpha = 1;
                  ctx.strokeRect(
                    x+10*zoom1,
                    y+zoom1*(5-5*radius1),
                    zoom1*10*range1,
                    zoom1*10*radius1);
                } else if (form1==1){
                  let centerX = x + 5 * zoom1;
                  let centerY = y + 5 * zoom1;
                  let attackLength = 10 * range1 * zoom1;
                  let targetWidth = 10 * radius1 * zoom1;
                  let halfWidth = Math.min(targetWidth / 2, attackLength);
                  
                  let angleSpread = Math.asin(halfWidth / attackLength);
                  ctx.globalAlpha = 0.25;
                  ctx.beginPath();
                  ctx.moveTo(centerX, centerY);
                  
                  ctx.arc(centerX, centerY, attackLength, -angleSpread, angleSpread);
                  
                  ctx.lineTo(centerX, centerY);
                  ctx.closePath();
                  ctx.globalAlpha = 1;
                  ctx.stroke();
                  ctx.globalAlpha = 0.25;
                  ctx.fill();
                }else{
                  // throw
                  circle(
                    x + 5 * zoom1 + 10 * range1 * zoom1,
                    y + 5 * zoom1,
                    10 * radius1 * zoom1
                  );
                  ctx.globalAlpha = 1;
                  ctx.stroke();
                  ctx.globalAlpha = 0.25;
                  ctx.fill();
                }
                //ctx.fillRect(10,10,10,10);
                ctx.globalAlpha = 1;
                ctx.fillStyle = "hsl(80 100 30)";
                ctx.fillRect(x,y,10*zoom1,10*zoom1)
                
              }
            }

            setInterval(draw1,0)

          </script>
        </div>
      </div>
    </div>
    
    
</body>
</html>




<!--
<canvas id="myCanvas" width="200" height="200"></canvas>
<button onclick="saveCanvas()">Save Canvas</button>

<script>
const canvas = document.getElementById('myCanvas');
const ctx = canvas.getContext('2d');

// Example drawing
ctx.fillStyle = 'red';
ctx.fillRect(20, 20, 160, 160);

function saveCanvas() {
  const link = document.createElement('a');
  link.href = canvas.toDataURL('image/png'); // Convert to base64 PNG
  link.download = 'canvasImage.png';
  link.click();
}
</script>
-->